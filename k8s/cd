pipeline {
  agent {
    kubernetes {
      yaml '''
        apiVersion: v1
        kind: Pod
        spec:
          containers:
          - name: sdk
            image: ogle/cloud-sdk
            command:
            - sleep
            args:
            - 99d
            tty: true
        '''
    }
  }
  environment {
    DH_CREDS=credentials('dockerhub_auth')
  }
    stages {
	  stage('Deploy Production') {
            steps{
            	sh 'apt install kubectl'
            	sh 'gcloud auth activate-service-account mostafa-ashour-project credentials('service-account') --key-file= credentials('gcloud-service-auth')'
            	sh 'kubectl apply -f k8s/app/python-deploy.yaml'
               
        } 
	}
}





















